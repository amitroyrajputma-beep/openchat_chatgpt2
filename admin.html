<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>Admin â€“ Approve Users</h2>
<div id="list"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="firebase.js"></script>

<script>
const list = document.getElementById("list");

firebase.database().ref("requests").on("value", snapshot => {
  list.innerHTML = "";

  snapshot.forEach(child => {
    const data = child.val();
    if (data.status !== "pending") return;

    const row = document.createElement("div");

    row.innerHTML = `
      <p><b>${data.name}</b></p>
      <input type="text" placeholder="Room name" class="roomInput">
      <button class="approveBtn">Approve</button>
      <button class="rejectBtn">Reject</button>
      <hr>
    `;

    const roomInput = row.querySelector(".roomInput");
    const approveBtn = row.querySelector(".approveBtn");
    const rejectBtn = row.querySelector(".rejectBtn");

    approveBtn.onclick = () => {
      const room = roomInput.value.trim();
      if (!room) {
        alert("Room required");
        return;
      }

      firebase.database().ref("requests/" + child.key).set({
        name: data.name,
        status: "approved",
        room: room,
        time: data.time
      });
    };

    rejectBtn.onclick = () => {
      firebase.database().ref("requests/" + child.key).set({
        name: data.name,
        status: "rejected",
        room: "",
        time: data.time
      });
    };

    list.appendChild(row);
  });
});
</script>

</body>
</html>
